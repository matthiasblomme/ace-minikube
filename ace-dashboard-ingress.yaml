# ace-dashboard-ingress.yaml
apiVersion: networking.k8s.io/v1       # API group and version for Ingress resources
kind: Ingress                          # Defines an Ingress resource (manages external access to services)
metadata:
  name: ace-dashboard-ingress          # Name of the Ingress resource
  namespace: ace-demo                  # Namespace where the Ingress will be created
  annotations:                         # Annotations provide extra configuration to the ingress controller
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"   # Force traffic to backend over HTTPS
    nginx.ingress.kubernetes.io/proxy-ssl-verify: "false"   # Disable SSL certificate verification when proxying to backend
    nginx.ingress.kubernetes.io/ssl-redirect: "true"        # Redirect all HTTP requests to HTTPS
spec:
  ingressClassName: nginx              # Specifies which ingress controller to use (here: nginx)
  tls:                                 # TLS configuration
    - hosts:
        - ace-dash.local                 # Hostname for the dashboard
      secretName: ace-dashboard-tls      # Secret containing TLS certificate and key (created by cert-manager)
  rules:                               # Ingress rules for routing traffic
    - host: ace-dash.local               # Hostname to match incoming requests
      http:
        paths:
          - path: /apiv2                   # Path for API traffic
            pathType: Prefix               # Prefix match (all requests starting with /apiv2)
            backend:
              service:
                name: ace-dashboard-dash   # Service that backs the dashboard
                port:
                  number: 8300             # Service port for UI (proxies /apiv2 to API internally)
          - path: /                        # Path for UI traffic
            pathType: Prefix
            backend:
              service:
                name: ace-dashboard-dash   # Same service as above
                port:
                  number: 8300             # UI port
